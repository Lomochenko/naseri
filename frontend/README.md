# فرانت‌اند سیستم ERP یراق‌آلات ناصری

این پروژه فرانت‌اند سیستم مدیریت منابع سازمانی (ERP) برای فروشگاه یراق‌آلات ناصری است که با استفاده از قالب مدیریتی Materio طراحی شده است.

<div dir="rtl">
  <img src="https://raw.githubusercontent.com/themeselection/materio-vuetify-vuejs-admin-template-free/main/.github/images/materio-vuetify-vuejs-admin-template-free.png" alt="Materio Admin Template" />
</div>

## تکنولوژی‌های استفاده شده

- Vue.js 3 (Composition API)
- Vuetify 3 (کتابخانه UI)
- Vue Router (مدیریت مسیرها)
- Pinia (مدیریت state)
- Axios (ارتباط با API)
- SASS (استایل‌دهی)
- [Materio Admin Template](https://github.com/themeselection/materio-vuetify-vuejs-admin-template-free) (قالب مدیریتی)

## پیش‌نیازها

- Node.js 16.0.0 یا بالاتر
- npm 8.0.0 یا بالاتر

## نصب و راه‌اندازی

### نصب وابستگی‌ها

```bash
npm install
```

### اجرای پروژه در محیط توسعه

#### برای کاربران Bash / CMD

```bash
npm run dev
```

#### برای کاربران PowerShell

توجه داشته باشید که در PowerShell نمی‌توان از عملگر `&&` استفاده کرد. برای اجرای دستورات پشت سر هم باید از `;` استفاده کنید:

```powershell
cd frontend; npm run dev
```

یا به صورت جداگانه:

```powershell
cd frontend
npm run dev
```

### ساخت پروژه برای محیط تولید

```bash
npm run build
```

## اتصال به بک‌اند

این فرانت‌اند از طریق Axios با بک‌اند Django در ارتباط است. برای اتصال صحیح، باید مطمئن شوید که:

1. سرور بک‌اند در آدرس `http://localhost:8000` در حال اجراست
2. تنظیمات CORS در بک‌اند فعال است
3. فایل `.env` در مسیر اصلی پروژه با متغیر `VITE_API_URL` تنظیم شده است:

```
VITE_API_URL=http://localhost:8000
```

## ساختار پروژه

```
├── src/
│   ├── assets/             # فایل‌های استاتیک (تصاویر، فونت‌ها و ...)
│   ├── components/         # کامپوننت‌های قابل استفاده مجدد
│   │   ├── layouts/        # کامپوننت‌های مربوط به چیدمان صفحه
│   │   └── ...             # سایر کامپوننت‌های عمومی
│   ├── router/             # تنظیمات Vue Router و مسیرها
│   │   ├── index.js        # تنظیمات اصلی Router
│   │   └── guards.js       # محافظ‌های مسیر برای کنترل دسترسی
│   ├── store/              # مدیریت state با Pinia
│   │   ├── auth.js         # مدیریت احراز هویت
│   │   └── ...             # سایر store های برنامه
│   ├── utils/              # توابع و ابزارهای کمکی 
│   │   ├── axios.js        # پیکربندی Axios
│   │   └── rbac.js         # سیستم کنترل دسترسی‌ها
│   ├── views/              # صفحات اصلی برنامه
│   │   ├── auth/           # صفحات مرتبط با احراز هویت
│   │   ├── errors/         # صفحات خطا (403، 404)
│   │   ├── products/       # صفحات مدیریت محصولات
│   │   ├── inventory/      # صفحات مدیریت موجودی
│   │   ├── sales/          # صفحات مدیریت فروش
│   │   ├── purchases/      # صفحات مدیریت خرید
│   │   └── accounting/     # صفحات مدیریت حسابداری
│   ├── App.vue             # کامپوننت اصلی برنامه
│   ├── main.js             # نقطه ورود برنامه
│   └── style.css           # استایل‌های سراسری
├── public/                 # فایل‌های عمومی
├── index.html              # فایل HTML اصلی
└── vite.config.js          # تنظیمات Vite
```

## ویژگی‌ها

- رابط کاربری RTL (راست به چپ) برای زبان فارسی
- داشبورد مدیریتی زیبا بر پایه قالب Materio
- سیستم کنترل دسترسی (RBAC) برای مدیریت مجوزها
- قابلیت احراز هویت کاربران با توکن
- صفحات واکنش‌گرا (Responsive) برای نمایش مناسب در تمام دستگاه‌ها
- مدیریت محصولات و دسته‌بندی‌ها
- مدیریت موجودی انبار
- مدیریت فروش و مشتریان
- مدیریت خرید و تامین‌کنندگان
- داشبورد حسابداری و گزارش‌های مالی
- امنیت بالا در ارتباط با سرور

## امکانات قالب Materio

- طراحی مدرن و زیبا
- چیدمان عمودی (ساید‌بار) برای ناوبری آسان
- رابط کاربری متریال دیزاین
- کامپوننت‌های از پیش طراحی‌شده برای سرعت توسعه
- پشتیبانی کامل از حالت RTL
- سازگار با تمام دستگاه‌ها (موبایل، تبلت و دسکتاپ)
- حالت تاریک و روشن

## ساختار Vue.js و بهترین شیوه‌ها

### ساختار یک کامپوننت

هر کامپوننت Vue باید دارای ساختار استاندارد زیر باشد:

```vue
<template>
  <!-- محتوای HTML کامپوننت اینجا قرار می‌گیرد (فقط یک تگ template مجاز است) -->
  <div>
    محتوای کامپوننت
  </div>
</template>

<script setup>
// استفاده از Composition API
import { ref, computed, onMounted } from 'vue';

// کد JavaScript کامپوننت
const count = ref(0);
const doubleCount = computed(() => count.value * 2);

function increment() {
  count.value++;
}

onMounted(() => {
  console.log('کامپوننت نصب شد');
});
</script>

<style scoped>
/* استایل‌های خاص این کامپوننت */
</style>
```

### نکات مهم

1. هر فایل `.vue` باید فقط یک تگ `<template>` داشته باشد.
2. ترتیب صحیح تگ‌ها: `<template>` سپس `<script>` و در نهایت `<style>`.
3. استفاده از `<script setup>` برای Composition API توصیه می‌شود.
4. استفاده از `scoped` در تگ `<style>` برای محدود کردن استایل‌ها به همان کامپوننت.

## تغییرات و رفع باگ‌های اخیر

### رفع مشکل template دوتایی

- فایل `Dashboard.vue` دارای دو تگ `<template>` بود که باعث خطا در اجرا می‌شد. این مشکل با اصلاح ساختار کامپوننت رفع شد.

### بهبود ارتباط با API

- آدرس API محصولات در فایل `apiService.js` اصلاح شده است تا با ساختار بک‌اند مطابقت داشته باشد.
- مسیر `/api/products/products/` به `/api/products/` تغییر یافت.

### بهینه‌سازی‌های دیگر

- بهبود ساختار کامپوننت‌ها و استفاده بهتر از Vuetify
- استفاده از Composition API به جای Options API
- بهبود مدیریت state با Pinia
- اضافه کردن فایل `.env` برای تنظیمات محیطی
- بهبود پاسخگویی صفحات برای نمایش در دستگاه‌های مختلف

## عیب‌یابی متداول

### مشکل در اجرای دستورات در PowerShell

اگر در PowerShell با خطای `&&` مواجه شدید، از `;` به جای `&&` استفاده کنید یا دستورات را جداگانه اجرا کنید.

### خطای CORS در ارتباط با بک‌اند

مطمئن شوید که تنظیمات CORS در فایل `settings.py` جنگو فعال است و آدرس فرانت‌اند در `CORS_ALLOWED_ORIGINS` قرار دارد.

### خطای احراز هویت

تنظیمات توکن احراز هویت را در فایل `axios.js` و بک‌اند بررسی کنید. همچنین مطمئن شوید که مقادیر `TOKEN_KEY` در فایل `axios.js` و `auth.js` یکسان است.

### خطای Multiple Root Templates

اگر با خطای "Multiple root templates" مواجه شدید:
1. مطمئن شوید که فایل Vue فقط یک تگ `<template>` دارد
2. بررسی کنید که ترتیب تگ‌ها صحیح باشد: اول `<template>`، سپس `<script>`، و در آخر `<style>`
3. مطمئن شوید که داخل تگ `<template>` فقط یک المنت ریشه وجود دارد (معمولاً یک `<div>` که بقیه المنت‌ها را دربر می‌گیرد)

### خطای 404 برای API‌ها

اگر با خطای 404 برای درخواست به API‌ها مواجه شدید:
1. آدرس API را در فایل `utils/apiService.js` بررسی کنید
2. مطمئن شوید که آدرس API با ساختار URL‌های بک‌اند مطابقت دارد
3. چک کنید که سرور بک‌اند در حال اجرا باشد

## کاربران پیش‌فرض

برای ورود به سیستم از یکی از حساب‌های کاربری زیر استفاده کنید:

- **مدیر ارشد**:
  - شماره تلفن: 09122173180
  - رمز عبور: Admin@123

- **کارمند فروش**:
  - شماره تلفن: 09123456788
  - رمز عبور: Manager@123
